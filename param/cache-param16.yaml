id: cache-poisoning-param16

info:
  name: Cache Poisoning Detection
  author: erickfernandox
  severity: low
  tags: cache,generic
  metadata:
    max-request: 5

variables:
  cache_key: "{{to_lower(rand_base(6))}}"
  cache_header: "{{to_lower(rand_base(6))}}"

http:
  - raw:
      - |
        GET /?livro_id=FUZZ888&syndicationid=FUZZ889&mini=FUZZ890&affiliate=FUZZ891&clubcode=FUZZ892&plano=FUZZ893&ind=FUZZ894&done=FUZZ895&pais=FUZZ896&cidade=FUZZ897&estado=FUZZ898&endereco=FUZZ899&cep=FUZZ900&buildTime=FUZZ901&start_date=FUZZ902&skin=FUZZ903&pcode=FUZZ904&num=FUZZ905&codigo=FUZZ906&flow=FUZZ907&rbulid=FUZZ908&order_type=FUZZ909&anchor=FUZZ910&oferta=FUZZ911&bannerid=FUZZ912&secao=FUZZ913&sellerId=FUZZ914&idArquivo=FUZZ915&resultado=FUZZ916&end_url=FUZZ917&utm_code=FUZZ918&valor=FUZZ919&metodo=FUZZ920&errorMessage=FUZZ921&change_direction=FUZZ922&affiliateid=FUZZ923&mediaId=FUZZ924&skinPath=FUZZ925&eos=FUZZ926&promochild=FUZZ927&utm_term=FUZZ928&tpl=FUZZ929&project_id=FUZZ930&suggest=FUZZ931&origem=FUZZ932&proximo=FUZZ933&referral_source=FUZZ934&tag-id=FUZZ935&imagem=FUZZ936 HTTP/1.1
        Host: {{Hostname}}
        Accept-Encoding: gzip, deflate
        Accept: */*
        Accept-Language: en-US;q=0.9,en;q=0.8


      - |
        GET / HTTP/1.1
        Accept-Encoding: gzip, deflate
        Accept: */*
        Accept-Language: en-US;q=0.9,en;q=0.8

    matchers:
      - type: dsl
        dsl:
          - 'contains(body_2, cache_header)'
