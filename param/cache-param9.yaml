id: cache-poisoning-param3

info:
  name: Cache Poisoning Detection
  author: erickfernandox
  severity: low
  tags: cache,generic
  metadata:
    max-request: 5

variables:
  cache_key: "{{to_lower(rand_base(6))}}"
  cache_header: "{{to_lower(rand_base(6))}}"

http:
  - raw:
      - |
        GET /?securitytext={{cache_header}}440&panel={{cache_header}}441&subscrptionId={{cache_header}}442&promocode={{cache_header}}443&ordertype={{cache_header}}444&reg={{cache_header}}445&sms={{cache_header}}446&user_in={{cache_header}}447&item={{cache_header}}448&license_number={{cache_header}}449&originalurl={{cache_header}}450&formid={{cache_header}}451&reg_ip={{cache_header}}452&thumbnail={{cache_header}}453&arrival={{cache_header}}454&meeting_id={{cache_header}}455&internal={{cache_header}}456&ColumnId={{cache_header}}457&culture={{cache_header}}458&cflang={{cache_header}}459&filter_by={{cache_header}}460&sourceid={{cache_header}}461&sourceapp={{cache_header}}462&pageurl={{cache_header}}463&page_url={{cache_header}}464&stream={{cache_header}}465&ping={{cache_header}}466&execution={{cache_header}}467&location_id={{cache_header}}468&RootFolder={{cache_header}}469&root={{cache_header}}470&click={{cache_header}}471&ctag={{cache_header}}472&messageid={{cache_header}}473&message_id={{cache_header}}474&queryinput={{cache_header}}475&order_id={{cache_header}}476&keyword={{cache_header}}477&appId={{cache_header}}478&api={{cache_header}}479&releaseid={{cache_header}}480&relay={{cache_header}}481&root_id={{cache_header}}482&unknown={{cache_header}}483&auth_req={{cache_header}}484&search_geolocation={{cache_header}}485&params={{cache_header}}486&persons={{cache_header}}487&person={{cache_header}}488&search_request={{cache_header}}489&d={{cache_header}}490&purchases={{cache_header}}491&widget={{cache_header}}492&targetUrl={{cache_header}}493&public={{cache_header}}494&requestUrl={{cache_header}}495&redirect_back={{cache_header}}496&ListId={{cache_header}}497&module={{cache_header}}498&PageNum={{cache_header}}499&option={{cache_header}}500&CustomerID={{cache_header}}501&company_id={{cache_header}}502&login_link={{cache_header}}503&keys={{cache_header}}504&paymentType={{cache_header}}505&errorcode={{cache_header}}506&courseCode={{cache_header}}507&post_type={{cache_header}}508&send_to={{cache_header}}509&refid={{cache_header}}510&vouchercode={{cache_header}}511&os_destination={{cache_header}}512&redirected-from={{cache_header}}513&return_to_url={{cache_header}}514 HTTP/1.1
        Host: {{Hostname}}
        Accept-Encoding: gzip, deflate
        Accept: */*
        Accept-Language: en-US;q=0.9,en;q=0.8


      - |
        GET / HTTP/1.1
        Accept-Encoding: gzip, deflate
        Accept: */*
        Accept-Language: en-US;q=0.9,en;q=0.8

    matchers:
      - type: dsl
        dsl:
          - 'contains(body_2, cache_header)'
